<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    body { font-family: 'Helvetica Neue', Helvetica, Arial, serif; font-size: 1em; background: #e7e7e7; }
    pre { padding: 20px; overflow: auto; color: #f2f2f2; text-shadow: none; background: #303030; }
    .renderjson a { text-decoration: none; }
    .renderjson .disclosure { color: crimson; font-size: 150%; }
    .renderjson .syntax { color: grey; }
    .renderjson .string { color: red; }
    .renderjson .number { color: cyan; }
    .renderjson .boolean { color: plum; }
    .renderjson .key { color: lightblue; }
    .renderjson .keyword { color: lightgoldenrodyellow; }
    .renderjson .object.syntax { color: lightseagreen; }
    .renderjson .array.syntax { color: lightsalmon; }
  </style>
</head>

<body>
  <h2>Demo - Loading PT database file</h2>
  <span>Load a PT file</span>
  <input type="file" id="file-input" />
  <div id="output"></div>

  <script src="lib/zlib_and_gzip.v0.3.min.js"></script>
  <script src="lib/renderjson.js"></script>
  <script src="procrastitracker.js"></script>
  <script>
    var fileInput = document.getElementById("file-input");
    fileInput.addEventListener('change', function () {
      file = fileInput.files[0];
      fr = new FileReader();
      fr.onload = function () {
        var elm = document.getElementById("output");
        // reset output
        while (elm.hasChildNodes()) {
          elm.removeChild(elm.lastChild);
        }
        // load / decompress / shoe
        try
        {
          var compressed = new Zlib.Gunzip(new Uint8Array(fr.result));
          var decompressed = compressed.decompress();
          var json = PROCRASTITRACKER.load_db(decompressed);
          var parsed = PROCRASTITRACKER.parse(json);
          elm.appendChild( renderjson.set_show_to_level(3)(json) );
          elm.appendChild( renderjson.set_show_to_level(3)(parsed) );
          console.log(json);
        }
        catch (e)
        {
          elm.appendChild( document.createTextNode(e) );
        }
      };
      fr.readAsArrayBuffer(file);
    });
  </script>
</body>

</html>